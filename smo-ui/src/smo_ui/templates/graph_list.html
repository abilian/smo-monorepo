{% extends "base.html" %}
{% block title %}Graphs - SMO{% endblock %}
{% block content %}
  <header class="header">
    <div>
      <a
        href="{{ url_for('projects') }}"
        style="
          color: #4a5568;
          text-decoration: none;
          font-weight: 500;
          display: block;
          margin-bottom: 10px;
        "
        >&larr; All projects</a
      >
      <h1>Graphs</h1>
    </div>
    <a href="{{ url_for('deploy') }}" class="btn btn-primary"
      >Deploy a new Graph</a
    >
  </header>

  <div class="graph-list">
    {% if request.state.error %}
      <div class="card" style="background-color: #fee2e2; color: #dc2626">
        <strong>Error loading graphs:</strong> {{ request.state.error }}
      </div>
    {% endif %}
    {% for graph in graphs %}
      <div class="graph-item">
        <div class="graph-info">
          <h3>
            {{ graph.name }}
            <span class="status-badge status-{{ graph.status|lower }}">{{ graph.status }}</span>
          </h3>
          <p>Project: {{ graph.project }}</p>
        </div>
        <div class="graph-actions">
          <a
            href="{{ url_for('graph_details', graph_id=graph.name) }}"
            class="btn btn-secondary"
            >Details</a
          >
          {% if graph.status == 'Running' %}
            <a href="{{ url_for("graph_stop", graph_id=graph.name) }}" class="btn btn-secondary">Stop</a>
          {% elif graph.status == 'Stopped' %}
            <a href="{{ url_for("graph_start", graph_id=graph.name) }}" class="btn btn-secondary">Start</a>
          {% endif %}
          <a href="{{ url_for("graph_remove", graph_id=graph.name) }}" class="btn btn-danger">Remove</a>
        </div>
      </div>
    {% else %}
      <div class="card"><p>No graphs found in this project.</p></div>
    {% endfor %}
  </div>
{% endblock %}
